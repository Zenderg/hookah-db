# ==============================================================================
# Hookah Database API - Environment Variables Configuration
# ==============================================================================
# This file contains all environment variables used by the Hookah Database API.
# Copy this file to .env for local development or use .env.dev/.env.prod for
# Docker deployments.
#
# For more information, see:
# - Docker setup: docker-compose.dev.yml, docker-compose.prod.yml
# - Logging documentation: docs/LOGGING.md
# - API documentation: http://localhost:3000/api-docs (when running)
# ==============================================================================

# ------------------------------------------------------------------------------
# APPLICATION CONFIGURATION
# ------------------------------------------------------------------------------
# Node.js environment mode
# Options: development, staging, production
# Default: development
# Usage: Controls logging level, error handling, and feature flags
NODE_ENV=development

# Service name for identification in logs and monitoring
# Default: hookah-db
# Usage: Helps distinguish multiple service instances in logs
SERVICE_NAME=hookah-db

# Docker environment flag
# Options: true, false
# Default: false
# Usage: Set to true when running in Docker to enable Docker-specific features
# Note: Automatically set by docker-compose.yml files
DOCKER_ENABLED=false

# Container name (optional, for Docker environments)
# Default: hookah-db-api
# Usage: Helps identify containers in monitoring and logging
# Note: Only used when DOCKER_ENABLED=true
CONTAINER_NAME=hookah-db-api

# ------------------------------------------------------------------------------
# SERVER CONFIGURATION
# ------------------------------------------------------------------------------
# Port number for the API server
# Default: 3000
# Usage: The HTTP port on which the Express server listens
# Note: In Docker, this should match the exposed port in docker-compose.yml
PORT=3000

# ------------------------------------------------------------------------------
# EXTERNAL SERVICES
# ------------------------------------------------------------------------------
# Base URL for HTReviews.org (data source)
# Default: https://htreviews.org
# Usage: The root URL for scraping tobacco product data
# Note: Should not include trailing slash
HTREVIEWS_BASE_URL=https://htreviews.org

# ------------------------------------------------------------------------------
# CACHE CONFIGURATION
# ------------------------------------------------------------------------------
# Cache time-to-live in seconds
# Default: 86400 (24 hours)
# Usage: How long cached data remains valid before requiring refresh
# Note: Lower values = fresher data but more scraping requests
CACHE_TTL=86400

# ------------------------------------------------------------------------------
# REDIS CONFIGURATION (DOCKER)
# ------------------------------------------------------------------------------
# Redis connection URL for distributed caching
# Default: redis://redis:6379
# Usage: Connection string for Redis server (used in Docker deployments)
# Format: redis://[username:password@]host:port[/db-number]
# Examples:
#   - Local Docker: redis://redis:6379
#   - Remote Redis: redis://user:pass@redis.example.com:6379/0
#   - With TLS: rediss://redis.example.com:6379
# Note: Only used when Redis is configured as the cache backend
#       For local development without Docker, leave this empty to use in-memory cache
REDIS_URL=redis://redis:6379

# ------------------------------------------------------------------------------
# RATE LIMITING CONFIGURATION
# ------------------------------------------------------------------------------
# Rate limit time window in milliseconds
# Default: 60000 (1 minute)
# Usage: Time window for rate limiting requests
# Note: Adjust based on your API usage patterns and server capacity
RATE_LIMIT_WINDOW=60000

# Maximum number of requests per time window
# Default: 100
# Usage: Maximum requests allowed per IP address per time window
# Note: Set to 0 to disable rate limiting (not recommended for production)
RATE_LIMIT_MAX=100

# ------------------------------------------------------------------------------
# SCHEDULER CONFIGURATION
# ------------------------------------------------------------------------------
# Enable/disable the cron scheduler
# Options: true, false
# Default: true
# Usage: Controls whether automatic data refresh jobs run
# Note: Set to false to disable automatic scraping (manual refresh only)
SCHEDULER_ENABLED=true

# Cron schedule for brands data refresh
# Format: minute hour day month weekday (cron expression)
# Default: 0 2 * * * (2:00 AM UTC daily)
# Usage: Schedule for automatic brands data refresh
# Examples:
#   - Every 6 hours: 0 */6 * * *
#   - Every Monday at 3 AM: 0 3 * * 1
#   - Disable: comment out or set to empty string
# Note: All times are in UTC unless timezone is specified in code
CRON_SCHEDULE_BRANDS=0 2 * * *

# Cron schedule for flavors data refresh
# Format: minute hour day month weekday (cron expression)
# Default: 0 3 * * * (3:00 AM UTC daily)
# Usage: Schedule for automatic flavors data refresh
# Examples:
#   - Every 6 hours: 0 */6 * * *
#   - Every Tuesday at 4 AM: 0 4 * * 2
#   - Disable: comment out or set to empty string
# Note: All times are in UTC unless timezone is specified in code
CRON_SCHEDULE_FLAVORS=0 3 * * *

# Cron schedule for full data refresh (brands + flavors)
# Format: minute hour day month weekday (cron expression)
# Default: 0 4 * * * (4:00 AM UTC daily)
# Usage: Schedule for complete data refresh
# Examples:
#   - Weekly on Sunday at 5 AM: 0 5 * * 0
#   - Monthly on 1st at 3 AM: 0 3 1 * *
#   - Disable: comment out or set to empty string
# Note: All times are in UTC unless timezone is specified in code
CRON_SCHEDULE_ALL=0 4 * * *

# Maximum number of execution history entries to keep
# Default: 100
# Usage: Limits the size of scheduler execution history in memory
# Note: Higher values use more memory but provide more historical data
MAX_EXECUTION_HISTORY=100

# ------------------------------------------------------------------------------
# API KEYS
# ------------------------------------------------------------------------------
# API keys for client authentication
# Format: API_KEY_<CLIENT_NAME>=<key>
# Usage: Add one line per authorized client
# Examples:
#   API_KEY_CLIENT1=abc123def456
#   API_KEY_CLIENT2=xyz789uvw012
#   API_KEY_MOBILE_APP=mobile-key-123
# Note: Keys are validated via X-API-Key header in API requests
#       For production, use strong, randomly generated keys
#       Minimum length: 16 characters recommended
API_KEY_TEST=test-api-key-12345

# ------------------------------------------------------------------------------
# LOGGING CONFIGURATION
# ------------------------------------------------------------------------------
# Log level for the application
# Options: error, warn, info, http, verbose, debug, silly
# Default: info
# Usage: Controls verbosity of log output
# Levels:
#   - error: Only errors
#   - warn: Errors and warnings
#   - info: Errors, warnings, and informational messages (recommended for production)
#   - http: Includes HTTP request/response logs
#   - verbose: More detailed operational information
#   - debug: Debug information (recommended for development)
#   - silly: All possible logs (maximum verbosity)
# Note: Lower levels include all higher levels (e.g., debug includes info, warn, error)
LOG_LEVEL=info

# Directory for log files (relative to project root or container)
# Default: ./logs
# Usage: Directory where log files are stored
# Examples:
#   - Local development: ./logs
#   - Docker container: /app/logs
#   - Absolute path: /var/log/hookah-db
# Note: Directory will be created if it doesn't exist
#       In Docker, ensure this is a volume mount for persistence
LOG_DIR=./logs

# Maximum log file size before rotation
# Default: 20m
# Usage: Maximum size of each log file before rotation
# Format: <size><unit> where unit can be k, m, or g
# Examples: 10m, 50m, 1g
# Note: Only applicable when using file rotation
MAX_LOG_FILE_SIZE=20m

# Maximum number of log files to keep
# Default: 14d
# Usage: How long to keep rotated log files
# Format: <number><unit> where unit can be d (days) or number of files
# Examples: 7d, 30d, 10 (files)
# Note: Only applicable when using file rotation
MAX_LOG_FILES=14d

# Enable/disable request/response logging
# Options: true, false
# Default: true
# Usage: Controls whether HTTP requests and responses are logged
# Note: Set to false to reduce log volume in high-traffic scenarios
LOG_HTTP_REQUESTS=true

# ------------------------------------------------------------------------------
# DOCKER-SPECIFIC NOTES
# ------------------------------------------------------------------------------
# When using Docker Compose:
# 1. Use .env.dev for development: docker-compose -f docker-compose.dev.yml up
# 2. Use .env.prod for production: docker-compose -f docker-compose.prod.yml up
# 3. The REDIS_URL should use the service name as hostname (e.g., redis://redis:6379)
# 4. Ensure LOG_DIR is a volume mount for log persistence
# 5. Set DOCKER_ENABLED=true for Docker-specific optimizations
#
# Docker Compose automatically loads environment variables from:
# - .env (default, for local development)
# - .env.dev (for development environment)
# - .env.prod (for production environment)
#
# Environment variable precedence (highest to lowest):
# 1. Command line arguments (-e flag)
# 2. Environment file specified in docker-compose.yml
# 3. .env file in the same directory as docker-compose.yml
# 4. Shell environment variables
#
# For more information on Docker setup, see:
# - Dockerfile: Container image definition
# - docker-compose.dev.yml: Development environment configuration
# - docker-compose.prod.yml: Production environment configuration
# - .dockerignore: Files excluded from Docker build context

# ------------------------------------------------------------------------------
# LOCAL DEVELOPMENT NOTES
# ------------------------------------------------------------------------------
# For local development without Docker:
# 1. Copy this file to .env: cp .env.example .env
# 2. Adjust variables as needed for your environment
# 3. Leave REDIS_URL empty to use in-memory caching
# 4. Set LOG_LEVEL=debug for detailed logging
# 5. Set NODE_ENV=development
# 6. Run with: pnpm --filter @hookah-db/api dev
#
# For testing API endpoints:
# - Start the server: pnpm --filter @hookah-db/api dev
# - Access Swagger UI: http://localhost:3000/api-docs
# - Use API key: X-API-Key: test-api-key-12345
# - Health check: curl http://localhost:3000/health

# ------------------------------------------------------------------------------
# PRODUCTION DEPLOYMENT CHECKLIST
# ------------------------------------------------------------------------------
# Before deploying to production:
# [ ] Set NODE_ENV=production
# [ ] Change all API_KEY_* values to strong, randomly generated keys
# [ ] Set LOG_LEVEL=info (or warn for reduced verbosity)
# [ ] Configure REDIS_URL for your Redis instance
# [ ] Set DOCKER_ENABLED=true
# [ ] Review and adjust rate limiting (RATE_LIMIT_WINDOW, RATE_LIMIT_MAX)
# [ ] Configure scheduler schedules appropriately for your timezone
# [ ] Ensure LOG_DIR is a persistent volume mount
# [ ] Set up log rotation and monitoring
# [ ] Configure backup strategy for Redis data
# [ ] Review and test health check endpoints
# [ ] Set up proper error monitoring and alerting
# [ ] Configure HTTPS/TLS termination
# [ ] Review and adjust CACHE_TTL based on data freshness requirements
